# 开发原则与技术实践沉淀

本文档沉淀了项目开发过程中的核心原则与关键技术问题的处理经验，旨在提升代码质量并避免重复踩坑。

---

## 1. 编程与问题解决原则

### 精准对位，拒绝盲目尝试
在着手修改代码前，必须进行深度的问题定位。避免在未弄清根因的情况下，基于主观臆断进行“试错式”编程。盲目尝试往往会导致逻辑复杂度无意义地攀升，最终使系统变得难以维护。

### 文档先行与最佳实践
面对复杂的技术挑战（如 3D 渲染、复杂的状态管理等），应主动检索官方文档、社区深度讨论（如 GitHub Issues）以及业内的通用处理方式。优先采用经过验证的**最佳实践（Best Practices）**，确保方案的专业性与稳健性。

### 保持逻辑极简
如果一个问题的解决方案导致代码变得极其复杂且晦涩，那么往往说明切入问题的方向已经偏离。最优秀的方案通常具备极高的清晰度与极低的耦合度。

---

## 2. 3D 预览图生成 (Asset Generation) 经验

### 渲染管线分离 (Pipeline Separation)
**核心经验**：将“交互视图（Interactive View）”与“资产生成（Asset Generation）”完全分离。
- **做法**：在后台维护一个隐藏的、尺寸锁死在目标分辨率（如 1024x768）的专用渲染器实例。
- **收益**：确保生成的资产具备物理级的点对点精度，不受用户当前预览窗口尺寸、DPI 或缩放比例的影响，从源头上解决画质模糊问题。

### 物理像素对齐与重采样
**核心经验**：画质模糊的根因通常是“低像素截图 + 二次拉伸”。
- **做法**：确保截取的 Canvas 物理尺寸与最终输出尺寸严格 1:1 对应。通过锁定渲染器缓冲区尺寸，避免任何形式的像素插值。
- **细节**：在截图瞬间通过 `requestAnimationFrame` 确保 GPU 已完成在高分辨率下的帧重绘。

### WebGL 上下文稳定性
**核心经验**：避免在截图期间进行剧烈的 DOM 结构变动。
- **做法**：若需调整截图视角或尺寸，应在当前 DOM 位置通过样式偏移（如 `fixed` 布局推至屏幕外）来完成。
- **收益**：避免了 DOM 挂载点改变导致的 WebGL 上下文丢失，消除了捕获过程中的瞬间闪烁或黑屏现象。

### 导出质量优化
- **格式选择**：对于预览图展示，采用 `image/jpeg` 并设置 `0.9` 以上的质量参数，可以在保证视觉锐利度的同时，维持合理的图片体积。
- **资产管道思维**：将每一次截图视为一次微型的“离屏渲染任务”，而非简单的 UI 快照。
